
# 📈 تحلیل و پیش‌بینی قیمت سهام WebMellat 
در این پروژه، داده‌های مربوط به سهام بانک ملت (وبملت) از وب‌سایت TSETMC جمع‌آوری، پردازش، تحلیل و پیش‌بینی شده‌اند. همچنین داده‌های نرخ دلار از سایت tgju دریافت شده و با اطلاعات سهام مقایسه شده است. داشبورد نهایی در Power BI طراحی شده است که شامل KPIها، روند قیمت، روند نرخ ارز و بازدهی سالیانه، ماهانه ، روزانه و فصلی می‌باشد.

## 🧩 مراحل انجام پروژه

### 🔹 1️⃣ جمع‌آوری داده‌ها
- **Scraping داده سهام وبملت:** با استفاده از Python اطلاعات معاملات روزانه (قیمت پایانی، حجم، ارزش) استخراج شد.
  - 📂 فایل: `tsetmc_scraper.ipynb`
  - خروجی: `webmellat_tsetmc_data.xlsx`

- **API نرخ دلار:** دریافت قیمت دلار از tgju برای مقایسه با روند سهام.
  - 📂 پوشه: `tgju_api-main/`

### 🔹 3️⃣ مدل‌سازی و پیش‌بینی

- پیش پردازش و تولید ویژگی ها
   محاسبه بازده روزانه سهام (`Return`)- محاسبه میانگین متحرک ۵ و ۱۰ روزه (`MA_5`, `MA_10`) - مقیاس‌بندی داده‌ها با MinMaxScaler - آماده‌سازی داده‌های ورودی برای LSTM و GRU 
- طراحی مدل Deep Learning ترکیبی:
  - **LSTM:** برای یادگیری الگوهای زمانی
  - **GRU:** برای تکمیل LSTM و بهبود یادگیری وابستگی‌های طولانی
  - Dropout برای کاهش overfitting
- استفاده از EarlyStopping برای جلوگیری از بیش‌تمرینی
- ارزیابی مدل با MSE, RMSE و MAPE
- نمایش نمودار واقعی و پیش‌بینی‌شده
  - 📂 فایل: `webmellat_stock_price_forecasting.ipynb`

### 🔹 4️⃣ طراحی داشبورد Power BI

- داشبورد KPI برای روند قیمت سهام، روند نرخ دلار، درصد بازدهی فصلی
- اسلایسرهای سال و ماه برای تحلیل تعاملی
- استفاده از خروجی `persian_calendar.xlsx` برای نمایش تاریخ شمسی
  - 📂 فایل: `WebMellat_Stock_KPI_Dashboard.pbix`
## 📁 ساختار پروژه
stock-exchange/
│
├── fonts/ # فونت‌های فارسی برای نمودارها
├── tgju_api-main/ # اسکریپت دریافت نرخ ارز
├── persian_calendar.ipynb # ساخت تقویم شمسی
├── persian_calendar.xlsx # خروجی تقویم شمسی
├── tsetmc_scraper.ipynb # استخراج داده سهام وبملت
├── webmellat_tsetmc_data.xlsx # داده خام معاملات سهام
├── webmellat_stock_price_forecasting.ipynb # پیش‌بینی قیمت سهام
├── WebMellat_Stock_KPI_Dashboard.pbix # فایل داشبورد Power BI

## 🚀 تکنولوژی‌ها و ابزارها

- Python (Pandas, NumPy, Scikit-Learn, Keras, Matplotlib)
- Power BI Desktop
- Git & GitHub
## 📊 نتایج پیش‌بینی مدل

- **MSE:** حدود 169,000  
- **RMSE:** حدود 412  
- **MAPE:** حدود 8.8% (خطای نسبی مطلوب)
